<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÌöåÏãùÎπÑ Ï†ïÏÇ∞ Í≥ÑÏÇ∞Í∏∞ PRO</title>
    
    <!-- React & Tailwind CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        
        .category-border-beef { border-left: 4px solid #ef4444; }
        .category-border-pork { border-left: 4px solid #f97316; }
        .category-border-drink { border-left: 4px solid #3b82f6; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const Icons = {
            Receipt: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"/><path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"/><path d="M12 17V7"/></svg>,
            Plus: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Minus: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/></svg>,
            Users: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Clock: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Settings: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.72V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.17a2 2 0 0 1 1-1.74l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            Trash: ({size=18}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
            Check: ({size=20}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            RotateCcw: ({size=18}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        };

        const App = () => {
            // Î©îÎâ¥ Îç∞Ïù¥ÌÑ∞ ÏÉÅÌÉú (Ïù¥Ï†ú ÏΩîÎìúÍ∞Ä ÏïÑÎãå ÏÉÅÌÉúÎ°ú Í¥ÄÎ¶¨)
            const [categories, setCategories] = useState([
                {
                    id: 'beef',
                    name: 'üêÇ ÏÜåÍ≥†Í∏∞ Î©îÎâ¥',
                    borderClass: 'category-border-beef',
                    items: [
                        { id: 'b1', label: 'ÏÜå Îì±Ïã¨', price: 45000, icon: 'ü•©' },
                        { id: 'b2', label: 'ÏÜå Í∞àÎπÑÏÇ¥', price: 45000, icon: 'üçñ' },
                        { id: 'b3', label: 'ÏÜå ÏÇ¥ÏπòÏÇ¥', price: 45000, icon: 'üî•' },
                        { id: 'b4', label: 'ÏÜå ÏïàÏ∞ΩÏÇ¥', price: 45000, icon: '‚ú®' }
                    ]
                },
                {
                    id: 'pork',
                    name: 'üêñ ÎèºÏßÄÍ≥†Í∏∞ Î©îÎâ¥',
                    borderClass: 'category-border-pork',
                    items: [
                        { id: 'p1', label: 'ÎèºÏßÄÍ≥†Í∏∞', price: 15000, icon: 'ü•ì' }
                    ]
                },
                {
                    id: 'drink',
                    name: 'üç∫ Ï£ºÎ•ò Î∞è ÏùåÎ£å',
                    borderClass: 'category-border-drink',
                    items: [
                        { id: 'd1', label: 'ÏÜåÏ£º', price: 5000, icon: 'üß™' },
                        { id: 'd2', label: 'Îß•Ï£º', price: 6000, icon: 'üç∫' },
                        { id: 'd3', label: 'ÏùåÎ£åÏàò', price: 4000, icon: 'ü•§' }
                    ]
                }
            ]);

            const [counts, setCounts] = useState({});
            const [logs, setLogs] = useState([]);
            const [peopleCount, setPeopleCount] = useState(1);
            const [isEditMode, setIsEditMode] = useState(false);

            // Ï†ÑÏ≤¥ ÏïÑÏù¥ÌÖú Î¶¨Ïä§Ìä∏ Ï∂îÏ∂ú (Í≥ÑÏÇ∞Ïö©)
            const allItemsMap = useMemo(() => {
                const map = {};
                categories.forEach(cat => {
                    cat.items.forEach(item => {
                        map[item.id] = item;
                    });
                });
                return map;
            }, [categories]);

            // Ï¥ùÏï° Í≥ÑÏÇ∞
            const totalAmount = useMemo(() => {
                return Object.entries(counts).reduce((sum, [id, count]) => {
                    const item = allItemsMap[id];
                    return item ? sum + (item.price * count) : sum;
                }, 0);
            }, [counts, allItemsMap]);

            const perPersonAmount = peopleCount > 0 ? Math.floor(totalAmount / peopleCount) : 0;

            const handleUpdateCount = (id, delta) => {
                const current = counts[id] || 0;
                if (current + delta < 0) return;
                
                setCounts(prev => ({ ...prev, [id]: (prev[id] || 0) + delta }));
                
                const item = allItemsMap[id];
                const now = new Date();
                const timeStr = now.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
                
                setLogs(prev => [{
                    id: Date.now(),
                    name: item.label,
                    delta,
                    time: timeStr
                }, ...prev].slice(0, 20));
            };

            const handleReset = () => {
                if (window.confirm('Î™®Îì† Ï£ºÎ¨∏ ÎÇ¥Ïó≠ÏùÑ Ï¥àÍ∏∞ÌôîÌï†ÍπåÏöî?')) {
                    setCounts({});
                    setLogs([]);
                    setPeopleCount(1);
                }
            };

            // Î©îÎâ¥ Ìé∏Ïßë Í∏∞Îä•Îì§
            const updateItem = (catId, itemId, field, value) => {
                setCategories(prev => prev.map(cat => {
                    if (cat.id !== catId) return cat;
                    return {
                        ...cat,
                        items: cat.items.map(item => {
                            if (item.id !== itemId) return item;
                            return { ...item, [field]: field === 'price' ? parseInt(value) || 0 : value };
                        })
                    };
                }));
            };

            const addItem = (catId) => {
                const newItem = {
                    id: 'new-' + Date.now(),
                    label: 'ÏÉà Î©îÎâ¥',
                    price: 10000,
                    icon: 'üçΩÔ∏è'
                };
                setCategories(prev => prev.map(cat => {
                    if (cat.id !== catId) return cat;
                    return { ...cat, items: [...cat.items, newItem] };
                }));
            };

            const deleteItem = (catId, itemId) => {
                if (!window.confirm('Ïù¥ Î©îÎâ¥Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
                setCategories(prev => prev.map(cat => {
                    if (cat.id !== catId) return cat;
                    return { ...cat, items: cat.items.filter(i => i.id !== itemId) };
                }));
                // Í∞úÏàò Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎèÑ ÏÇ≠Ï†ú
                setCounts(prev => {
                    const next = { ...prev };
                    delete next[itemId];
                    return next;
                });
            };

            const formatMoney = (val) => val.toLocaleString('ko-KR');

            return (
                <div className="min-h-screen bg-slate-100 pb-12 font-sans select-none max-w-md mx-auto">
                    {/* ÏÉÅÎã® Í≥†Ï†ï Ìó§Îçî */}
                    <div className="sticky top-0 z-30 bg-white shadow-md border-b border-slate-200 animate-fadeIn">
                        <div className="bg-slate-900 px-4 py-3 flex justify-between items-center text-white">
                            <h1 className="flex items-center gap-2 font-bold text-sm">
                                <Icons.Receipt /> {isEditMode ? 'Î©îÎâ¥Ìåê Ìé∏Ïßë Ï§ë' : 'ÌöåÏãùÎπÑ Ïã§ÏãúÍ∞Ñ Ï†ïÏÇ∞'}
                            </h1>
                            <div className="flex items-center gap-2">
                                {!isEditMode && (
                                    <button onClick={handleReset} className="p-2 text-slate-400 hover:text-white transition-colors">
                                        <Icons.RotateCcw size={18} />
                                    </button>
                                )}
                                <button 
                                    onClick={() => setIsEditMode(!isEditMode)}
                                    className={`p-2 rounded-full transition-all ${isEditMode ? 'bg-green-500 text-white' : 'text-slate-400 hover:bg-slate-800'}`}
                                >
                                    {isEditMode ? <Icons.Check size={20} /> : <Icons.Settings size={20} />}
                                </button>
                            </div>
                        </div>
                        <div className="p-5 text-center bg-white">
                            <span className="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Total Bill</span>
                            <div className="text-4xl font-black text-slate-900 tracking-tighter">
                                {formatMoney(totalAmount)}<span className="text-xl ml-1 text-slate-400 font-normal">Ïõê</span>
                            </div>
                        </div>
                    </div>

                    <div className="p-4 space-y-6">
                        {/* Î©îÏù∏ Î©îÎâ¥ ÏòÅÏó≠ */}
                        {categories.map(cat => (
                            <section key={cat.id} className="space-y-3">
                                <div className="flex justify-between items-center px-1">
                                    <h2 className="text-xs font-black text-slate-500 uppercase tracking-widest">{cat.name}</h2>
                                    {isEditMode && (
                                        <button onClick={() => addItem(cat.id)} className="text-[10px] font-bold text-blue-600 flex items-center gap-1 bg-blue-50 px-2 py-1 rounded-full active:scale-95">
                                            <Icons.Plus size={12} /> Ìï≠Î™© Ï∂îÍ∞Ä
                                        </button>
                                    )}
                                </div>
                                <div className="space-y-2">
                                    {cat.items.map(item => (
                                        <div key={item.id} className={`bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition-all ${cat.borderClass} ${isEditMode ? 'p-3' : 'p-4 flex items-center justify-between'}`}>
                                            {isEditMode ? (
                                                <div className="flex flex-col gap-2">
                                                    <div className="flex items-center gap-2">
                                                        <input 
                                                            className="w-8 text-center bg-slate-50 border border-slate-200 rounded p-1 text-sm"
                                                            value={item.icon} 
                                                            onChange={(e) => updateItem(cat.id, item.id, 'icon', e.target.value)}
                                                        />
                                                        <input 
                                                            className="flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 text-sm font-bold"
                                                            value={item.label} 
                                                            onChange={(e) => updateItem(cat.id, item.id, 'label', e.target.value)}
                                                            placeholder="Î©îÎâ¥ Ïù¥Î¶Ñ"
                                                        />
                                                        <button onClick={() => deleteItem(cat.id, item.id)} className="p-2 text-rose-400 active:text-rose-600">
                                                            <Icons.Trash size={16} />
                                                        </button>
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <span className="text-[10px] text-slate-400 font-bold w-12 text-center uppercase">Price</span>
                                                        <input 
                                                            type="number"
                                                            className="flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 text-sm font-mono text-blue-600"
                                                            value={item.price} 
                                                            onChange={(e) => updateItem(cat.id, item.id, 'price', e.target.value)}
                                                        />
                                                        <span className="text-xs text-slate-400">Ïõê</span>
                                                    </div>
                                                </div>
                                            ) : (
                                                <>
                                                    <div className="flex items-center gap-4">
                                                        <div className="text-2xl drop-shadow-sm">{item.icon}</div>
                                                        <div>
                                                            <h3 className="font-bold text-slate-800 text-sm leading-none">{item.label}</h3>
                                                            <p className="text-slate-400 text-[11px] mt-1.5 font-medium">{formatMoney(item.price)}Ïõê</p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center gap-2 bg-slate-100 rounded-xl p-1">
                                                        <button 
                                                            onClick={() => handleUpdateCount(item.id, -1)}
                                                            disabled={!counts[item.id]}
                                                            className={`w-10 h-10 rounded-lg flex items-center justify-center transition-all ${!counts[item.id] ? 'text-slate-300' : 'bg-white text-rose-500 shadow-sm active:scale-90'}`}
                                                        >
                                                            <Icons.Minus size={18} />
                                                        </button>
                                                        <span className={`w-6 text-center font-black text-sm ${counts[item.id] ? 'text-slate-900' : 'text-slate-300'}`}>
                                                            {counts[item.id] || 0}
                                                        </span>
                                                        <button 
                                                            onClick={() => handleUpdateCount(item.id, 1)}
                                                            className="w-10 h-10 bg-white text-blue-600 rounded-lg shadow-sm flex items-center justify-center active:scale-90 transition-all"
                                                        >
                                                            <Icons.Plus size={18} />
                                                        </button>
                                                    </div>
                                                </>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </section>
                        ))}

                        {/* ÌïòÎã® Ï†ïÏÇ∞ Î∞è Î°úÍ∑∏ (Ìé∏Ïßë Î™®ÎìúÍ∞Ä ÏïÑÎãê ÎïåÎßå ÎÖ∏Ï∂ú) */}
                        {!isEditMode && (
                            <div className="space-y-4 pt-4 animate-fadeIn">
                                {/* 1/N Ï†ïÏÇ∞ */}
                                <div className="bg-indigo-600 rounded-3xl shadow-xl p-6 text-white overflow-hidden relative">
                                    <div className="absolute top-[-20px] right-[-20px] w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>
                                    <div className="flex items-center justify-between mb-6 relative z-10">
                                        <div className="flex items-center gap-2 opacity-80 text-xs font-bold uppercase tracking-widest">
                                            <Icons.Users size={16} /> Ïù∏ÏõêÏàò ÏÑ§Ï†ï
                                        </div>
                                        <div className="flex items-center gap-4">
                                            <button onClick={() => setPeopleCount(p => Math.max(1, p - 1))} className="w-9 h-9 rounded-xl bg-indigo-500/50 flex items-center justify-center hover:bg-indigo-400 transition-colors active:scale-90"><Icons.Minus size={16}/></button>
                                            <span className="font-black text-2xl w-8 text-center">{peopleCount}</span>
                                            <button onClick={() => setPeopleCount(p => p + 1)} className="w-9 h-9 rounded-xl bg-indigo-500/50 flex items-center justify-center hover:bg-indigo-400 transition-colors active:scale-90"><Icons.Plus size={16}/></button>
                                        </div>
                                    </div>
                                    <div className="flex justify-between items-end border-t border-white/10 pt-5 relative z-10">
                                        <span className="text-[10px] font-bold opacity-60 uppercase tracking-tighter">Amount per person</span>
                                        <span className="text-3xl font-black">{formatMoney(perPersonAmount)}<span className="text-lg font-normal ml-0.5 opacity-80">Ïõê</span></span>
                                    </div>
                                </div>

                                {/* ÌÉÄÏûÑÎùºÏù∏ Î°úÍ∑∏ */}
                                <div className="bg-white rounded-3xl shadow-sm p-6 border border-slate-200">
                                    <div className="flex items-center justify-between mb-4 border-b border-slate-50 pb-3">
                                        <h3 className="font-black text-slate-800 text-[10px] flex items-center gap-2 uppercase tracking-widest"><Icons.Clock size={14} /> Ï£ºÎ¨∏ ÌÉÄÏûÑÎùºÏù∏</h3>
                                        <span className="text-[10px] font-bold text-slate-300">{logs.length} events</span>
                                    </div>
                                    <div className="space-y-3 max-h-48 overflow-y-auto custom-scrollbar pr-1">
                                        {logs.length === 0 ? (
                                            <div className="text-center py-10 text-slate-300 text-xs italic">Í∏∞Î°ùÎêú Ï£ºÎ¨∏ ÎÇ¥Ïó≠Ïù¥ ÏóÜÏäµÎãàÎã§.</div>
                                        ) : (
                                            logs.map(log => (
                                                <div key={log.id} className="flex justify-between items-center group animate-fadeIn">
                                                    <div className="flex items-center gap-3">
                                                        <span className="text-[9px] font-mono font-bold text-slate-300 bg-slate-50 px-2 py-1 rounded-md">{log.time}</span>
                                                        <span className="text-[13px] text-slate-600 font-bold">{log.name}</span>
                                                    </div>
                                                    <span className={`text-[10px] font-black px-2.5 py-1 rounded-full ${log.delta > 0 ? 'bg-blue-50 text-blue-600' : 'bg-rose-50 text-rose-600'}`}>
                                                        {log.delta > 0 ? `+ 1` : `Ï∑®ÏÜå`}
                                                    </span>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

